<!DOCTYPE html>
<html>
<head>
    <title> Wildfires and Endangered Vegetation in California</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <script src="https://unpkg.com/esri-leaflet@3.0.10/dist/esri-leaflet.js"></script>
    <script src="https://unpkg.com/esri-leaflet-vector@4.1.0/dist/esri-leaflet-vector.js" crossorigin=""></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        #map { height: 500px; width: 1000px; }
        html, body { height: 100%; margin: 0; padding: 0; }
        #buttons { padding: 5px; }
    </style>
</head>
<body onload="initialize()">
    <h1> Wildfires and Endangered Vegetation in California </h1>
    <div id="map"></div>
    <div id="buttons">
        <button id="toggleVeg">Toggle the Endangered Vegetation Layer</button>
        <button id="toggleFire">Toggle the Wildfire Layer</button>
        <button id="togglePop">Toggle the Population Layer</button>
    </div>

    <script>
        function initialize() {
            var vegLayer;
            var fireLayer;
            var popLayer;
            var fireVisible = false;
            var vegVisible = true;
            var popVisible= false;
            const apiKey = "AAPK5c56055b0da1494abff6de6f7d7455c8zhvX__FodLqdRT-HFqoHfFXoa6-FTvBdD5zX_UQ85CR-RXVk0mOieuNm0Bv-oV6O";
            const map = L.map("map").setView([37.487118, -119.967690], 6);

            L.esri.Vector.vectorBasemapLayer("osm/standard-relief", {
                apikey: apiKey
            }).addTo(map);

            vegLayer= L.esri.imageMapLayer({
                url: "https://landscape12.arcgis.com/arcgis/rest/services/USA_CONUS_imperiled_species_richness_Plants/ImageServer",
                apiKey: apiKey,
                opacity: 0.8, 
                useCors: false
            }).addTo(map);

            fireLayer = L.esri.featureLayer({
                url: "https://services1.arcgis.com/jUJYIo9tSA7EHvfZ/ArcGIS/rest/services/California_Fire_Perimeters_last_5_years_View/FeatureServer/0",
                apiKey: apiKey,
                opacity: 0.8, 
                useCors: false,
                color: "red", 
                  onEachFeature: function(feature, layer) {
                   layer.bindPopup("<b> Fire: " + feature.properties.FIRE_NAME + "</b><br> Year: " + feature.properties.YEAR_);
                 }
            }).addTo(map);
            popLayer = L.esri.tiledMapLayer({
                url: "https://tiles.arcgis.com/tiles/4yjifSiIG17X0gW4/arcgis/rest/services/Population_Pressure_2015/MapServer",
                apiKey: apiKey,
                opacity: 0.8, 
                useCors: false
            });
            
      $("#togglePop").click(function () {
                if (popVisible) {
                    popVisible = false;
                    popLayer.removeFrom(map);
                } else {
                    popVisible = true;
                    popLayer.addTo(map);
                    if (vegVisible) {
                        vegVisible = false;
                        vegLayer.removeFrom(map);
                    }}
                     });
            
              $("#toggleVeg").click(function () {
                if (vegVisible) {
                    vegVisible = false;
                    vegLayer.removeFrom(map);
                } else {
                    vegVisible = true;
                    vegLayer.addTo(map);
                    if (popVisible) {
                        popVisible = false;
                        popLayer.removeFrom(map);
                    }
                }
            });
            
          $("#toggleFire").click(function () {
          if (fireVisible) {
            fireVisible = false;
            fireLayer.removeFrom(map);
          } else { fireVisible= true; 
                  fireLayer.addTo(map);
          }
        });
      }
    </script>
</body>
</html>

